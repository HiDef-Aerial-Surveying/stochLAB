# Script to store parameter values and outputs from the Band Collision risk
# spreadsheet ("Final_Report_SOSS02_BandSpreadSheetWorkedExampl1.xlsm")
# for unit testing functions

# generate list object with relevant parameters & outputs ----------------------
band_spreadsheet_dt <-
  list(
    n_turbines = 200,
    wf_width = 7.8,
    wf_latitude = 55.8,
    flight_speed = 14.9,
    rotor_radius = 57.5,
    rotor_speed = 9.9,
    hub_ht = 80,
    tid_offset = 2.5,
    body_length = 0.94,
    wing_span = 1.72,
    blade_width = 4.21,
    blade_pitch = 15 * pi/180, # functions expect pitch in radians
    n_blades = 3,
    prop_upwd = 0.5,
    flight_type = "gliding",
    flap_glide_fact = 2/pi,
    avoid_rate = 0.96,
    avoid_rate_ext = 0.96,
    lrg_arr_corr = TRUE,
    lac_factor = 0.997509719422808,
    xinc = 0.05,
    yinc = 0.05,
    day_night_hrs = DayLength(55.8),
    bird_density = c(0.05, 0.47, 1.49, 1.4, 0.88, 1.04, 0.57, 1.8, 2.79,
                     0.83, 0.5, 0.12),
    bird_dens_df = data.frame(month = month.abb,
                              dens = c(0.05, 0.47, 1.49, 1.4, 0.88, 1.04, 0.57,
                                       1.8, 2.79, 0.83, 0.5, 0.12)),
    noct_activity = 0.50,
    prop_crh_surv = 0.0828,
    chord_profile = chord_prof_5MW,
    avg_prob_coll = 0.0759263489343179,
    flux_fct = c(23807.1128188961, 213918.4113721500, 801006.6796081740,
                 775972.9803947000, 531910.3103724870, 626541.6366703440,
                 350409.5317177910, 1056412.6149214500, 1493025.0776912400,
                 430059.4955450120, 235172.1281308570, 56090.6837261335),
    n_transits_opt1 = c(1971.22894, 17712.44446, 66323.35307, 64250.56278,
                        44042.17370, 51877.64752, 29013.90923, 87470.96452,
                        123622.47643, 35608.92623, 19472.25221, 4644.30861),
    collisions_opt1 = c(5.052160, 45.396096, 169.983388, 150.461738, 87.393612,
                        100.269903, 56.781702, 190.264605, 275.641686, 85.222764,
                        48.254646, 11.903127),
    collisions_opt2 = c(3.46371159414228, 31.1231222074988, 116.538958094159,
                        103.155104523527, 59.9162106382357, 68.7440708237399,
                        38.9289831174607, 130.443563085681, 188.977259666109,
                        58.4278980398547, 33.0829160718166, 8.16066832729803),
    collisions_opt3 = c(1.04655444225758, 9.40379731911515, 35.21204377863720,
                        31.16813566788180, 18.10357897947740, 20.77090160194760,
                        11.76232463552940, 39.41329602675290, 57.09915078486910,
                        17.65388791283720, 9.99594563137059, 2.46573176131870),
    prop_oper = c(0.846, 0.846, 0.846, 0.773, 0.655, 0.638, 0.646, 0.718, 0.736,
                  0.790, 0.818, 0.846),
    prop_oper_df = data.frame(month = month.abb,
                              prop_oper = c(0.846, 0.846, 0.846, 0.773, 0.655, 0.638,
                                       0.646, 0.718, 0.736,0.790, 0.818, 0.846)),
    mean_prop_oper = 0.763166666666667,
    d_y = list(
      y = seq(-1, 1, 0.05),
      dy = c(0.484149991534650000, 0.338531250599772000, 0.213468748843297000, 0.124774999567308000,
             0.070725003024563200, 0.036440624680835800, 0.017393750240444200, 0.007834375246602580,
             0.004025000107503730, 0.001796875085346980, 0.001149999970948560, 0.000574999985474278,
             0.000574999985474278, 0.000000000000000000, 0.000000000000000000, 0.000000000000000000,
             0.000000000000000000, 0.000000000000000000, 0.000000000000000000, 0.000574999985474278,
             0.000574999985474278, 0.001365625043945330, 0.002299999941897110, 0.003521875041769820,
             0.005749999854742780, 0.009056250346475280, 0.011931249646295300, 0.012650000098801700,
             0.011212500030524100, 0.007618750278197690, 0.004887499981123260, 0.002803125007631020,
             0.001149999970948560, 0.000574999985474278, 0.000000000000000000, 0.000000000000000000,
             0.000000000000000000, 0.000000000000000000, 0.000000000000000000, 0.000000000000000000,
             0.000000000000000000)
    ),
    fhd = read.csv("data-raw/gannet_fhd_Band_spreadsheet.csv"),
    prop_crh_fhd = 0.0567668749151835
  )


usethis::use_data(band_spreadsheet_dt, overwrite = TRUE)
#save(band_spreadsheet_dt, file = "tests/test_data/band_spreadsheet_dt.rda")



# generate list object with for second case ----------------------------------
band_spreadsheet_dt_2 <-
  list(
    n_turbines = 100,
    wf_width = 10,
    wf_latitude = 55.8,
    flight_speed = 7.26,
    rotor_radius = 50,
    rotor_speed = 10,
    hub_ht = 75,
    tid_offset = 2.5,
    body_length = 0.39,
    wing_span = 1.08,
    blade_width = 5.5,
    blade_pitch = 2 * pi/180, # functions expect pitch in radians
    n_blades = 3,
    prop_upwd = 0.5,
    flight_type = "flapping",
    flap_glide_fact = 1,
    avoid_rate = 0.98,
    avoid_rate_ext = 0.98,
    lrg_arr_corr = TRUE,
    lac_factor = 0.999349863518097,
    xinc = 0.05,
    yinc = 0.05,
    day_night_hrs = DayLength(55.8),
    bird_density = c(0.97, 1.04, 1.15, 0.48, 0.56, 0.63, 0.68, 0.64, 0.53, 1.2,
                     1.02, 0.99),
    bird_dens_df = data.frame(month = month.abb,
                                dens = c(0.97, 1.04, 1.15, 0.48, 0.56, 0.63,
                                         0.68, 0.64, 0.53, 1.2, 1.02, 0.99)),
    noct_activity = 0.50,
    prop_crh_surv = 0.06,
    chord_profile = chord_prof_5MW,
    avg_prob_coll = 0.0979769390640759,
    flux_fct = c(97843.27393827260, 100278.11516954100, 130969.51700273300,
                 56361.47071740070, 71707.78038870410, 80404.37189408820,
                 88558.95526159090, 79572.60276190750, 60084.33862172270,
                 131720.75492591200, 101633.88638661400, 98031.85006643600),
    n_transits_opt1 = c(5870.596436, 6016.68691, 7858.17102, 3381.688243,
                        4302.466823, 4824.262314, 5313.537316, 4774.356166,
                        3605.060317, 7903.245296, 6098.033183, 5881.911004),
    collisions_opt1 = c(11.0685244496053, 11.37342163123380, 14.74668437028490,
                        6.14411528982121, 7.65529062950892, 8.71219229220874,
                        9.27217455798773, 8.40702875540984, 6.61560998213863,
                        14.8792485948029, 11.6000350899059, 11.1048309731404),
    collisions_opt2 = c(9.05993818818609, 9.30950619807600, 12.07062869886280,
                        5.02915316312593, 6.26609809028557, 7.13120561014048,
                        7.58956884884832, 6.88141958009879, 5.41508651746802,
                        12.1791367195630, 9.49499649875050, 9.08965622879337),
    collisions_opt3 = c(3.05960705385581, 3.14388798686169, 4.07633914761942,
                        1.69838161952207, 2.11610692247212, 2.40826002717468,
                        2.56305262832149, 2.32390546717704, 1.82871412165801,
                        4.11298309580519, 3.20652941118239, 3.06964305242226),
    prop_oper = c(0.9628, 0.9653, 0.9583, 0.9278, 0.9086, 0.9222, 0.8911, 0.8992,
                  0.9371, 0.9614, 0.9714, 0.9641),
    prop_oper_df = data.frame(month = month.abb,
                              prop_oper = c(0.9628, 0.9653, 0.9583, 0.9278, 0.9086,
                                       0.9222, 0.8911, 0.8992, 0.9371, 0.9614,
                                       0.9714, 0.9641)),
    mean_prop_oper = 0.939108333333333,
    d_y = list(
      y = seq(-1, 1, 0.05),
      dy = c(0.26501449756324300, 0.20204975735396100, 0.15444802120327900,
            0.11767914984375200, 0.08989127236418430, 0.06843555020168420,
            0.05222857580520210, 0.03972155100200330, 0.03028064966201780,
            0.02300030027981850, 0.01750967494444920, 0.01327954960288480,
            0.01009292464004830, 0.00764069991419092, 0.00579597508476581,
            0.00437999988207594, 0.00331500013999175, 0.00249500008067116,
            0.00188499998330371, 0.00141500004247064, 0.00106500001493259,
            0.00079999999798019, 0.00060000002122251, 0.00044700000216835,
            0.00033399999210815, 0.00024850000954757, 0.00018499999896449,
            0.00013650000028065, 0.00010124999789696, 0.00007450000225617,
            0.00005499999815584, 0.00004025000066576, 0.00002950000066448,
            0.00002145000053133, 0.00001559999986966, 0.00001129999986915,
            0.00000817500023231, 0.00000584999995112, 0.00000420750012609,
            0.00000299500015899, 0.00000213500008783
            )
      ),
    fhd = read.csv("data-raw/kittiwake_fhd_Band_comparison_spreadsheet.csv"),
    prop_crh_fhd = 0.0491119022925002
  )

usethis::use_data(band_spreadsheet_dt_2, overwrite = TRUE)
#save(band_spreadsheet_dt_2, file = "tests/test_data/band_spreadsheet_dt_2.rda")
